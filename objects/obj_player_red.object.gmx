<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprite_player_red_64_anim</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>1</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>script_create_player_common_local_vars</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/* Initalise stats */

//DEFAULT VALUES
characterBonus = - 1;
attack = 10;
dicePool = 1;
sidedDiceDefense = 6
sidedDiceHitPoints = 4
totalActionPoints = 2;
damage = 1;
totalNumberOfAttacks = 1;
moveSpeed = 4;


//INI file -- read existing or create using defaults
ini_open("config.ini");
    characterBonus = script_ini_read_key("Red_Player_Stats","character_bonus", characterBonus,"real");
    attack = script_ini_read_key("Red_Player_Stats","attack", attack,"real");
    dicePool = script_ini_read_key("Red_Player_Stats","dice_pool", dicePool,"real");
    sidedDiceDefense = script_ini_read_key("Red_Player_Stats","sided_dice_defense", sidedDiceDefense,"real");
    sidedDiceHitPoints = script_ini_read_key("Red_Player_Stats","sided_dice_hit_points", sidedDiceHitPoints,"real");
    totalActionPoints = script_ini_read_key("Red_Player_Stats","move_points", totalActionPoints,"real");
    damage = script_ini_read_key("Red_Player_Stats","damage", damage,"real");
    totalNumberOfAttacks = script_ini_read_key("Red_Player_Stats","number_of_attacks", totalNumberOfAttacks,"real");
ini_close();

randomize();

//Defense
defense = floor(random(sidedDiceDefense)) + 1 + characterBonus ;
if (defense &lt; 1) defense = 1;
//Hit Points
totalHitPoints = floor(random(sidedDiceHitPoints)) + 1 + characterBonus ;
if (totalHitPoints &lt; 1) totalHitPoints = 1;

hitPoints = totalHitPoints;
actionPoints = totalActionPoints;
numberOfAttacks = totalNumberOfAttacks;

equippedWeaponName = "";
equippedWeaponAttack = 0;
equippedWeaponDicePool = 0;
equippedWeaponDefense = 0;
equippedWeaponDamage = 0;
equippedWeaponTotalHitPoints = 0;
equippedWeaponHitPoints = 0;
equippedWeaponTotalActionPoints = 0;
equippedWeaponActionPoints = 0;
equippedWeaponTotalNumberOfAttacks = 0;
equippedWeaponNumberOfAttacks = 0;
equippedWeaponString = "";

equippedArmourName = "";
equippedArmourAttack = 0;
equippedArmourDicePool = 0;
equippedArmourDefense = 0;
equippedArmourDamage = 0;
equippedArmourTotalHitPoints = 0;
equippedArmourHitPoints = 0;
equippedArmourTotalActionPoints = 0;
equippedArmourActionPoints = 0;
equippedArmourTotalNumberOfAttacks = 0;
equippedArmourNumberOfAttacks = 0;

equippedArmourString = "";

inventorySlotWeapon = 0;
inventorySlotArmour = 0;
equippedWeapon = 0;
equippedArmour = 0;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>moveTimer = gridSize;
script_create_mp_grid();
createNewPath = true;
//stubIdForThisPlayer = instance_create(x,y,obj_player_stub);
//stubIdForThisPlayer.objCreatedBy = id;
//stopMe = false;
//old_path_positionprevious = 0;

    

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>script_move_me</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>script_player_states</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>script_turn_am_i_current_player</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>script_stats_window</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>typeOfWindow</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>id</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (amICurrentPlayer)
{
    if (createNewPath)
    {
        //show_message("Create Path");
        instance_deactivate_object(id);
        mp_grid_clear_all(AI_grid);
        mp_grid_add_instances(AI_grid,obj_player_red,true);
        mp_grid_add_instances(AI_grid,obj_wall_hidden,false);
        instance_activate_object(id);
        
        
        mypath=path_add(); //creates an empty path...
        //show_message(mypath);
        pathExists = mp_grid_path(AI_grid,mypath,x,y,obj_player_blue.x,obj_player_blue.y,true);
        //show_message("mypath1: " + string(mypath));
        
        if (pathExists)
        {
            //show_message("mypath: "+string(mypath) );
            path_set_kind(mypath,0); //Sets the path to allow diagonals
            path_set_precision(mypath,1); //Sets the precision to make it curvy. Can be 1-8. 1 is straight, 8 curvy...
        }
        else
        {
            //show_message("NO PATH");
            //show_message("Create Path");
            
            instance_deactivate_object(id);
            mp_grid_clear_all(AI_grid);
            //mp_grid_add_instances(AI_grid,obj_player_red,true);
            mp_grid_add_instances(AI_grid,obj_wall_hidden,false);
            instance_activate_object(id);
            //obj=instance_nearest(x,y,obj_Enemy_Parent);
            mypath=path_add(); //creates an empty path...
            pathExists = mp_grid_path(AI_grid,mypath,x,y,obj_player_blue.x,obj_player_blue.y,true);
            
            
        }
        createNewPath = false;
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_sprite_ext(sprite_index,image_index,x,y,1,1,image_angle,-1,1);

if (amICurrentPlayer)
{  
    obj_master.playerHighlightId.x = x;
    obj_master.playerHighlightId.y = y;
    
    
    //show_message("moveTimer: "+string(moveTimer) );
    if (actionPoints &gt; 0)
    {
        if (moveTimer &gt; 0)
        {
            if (moveTimer == gridSize) {
                pathIncrements = 1/(gridSize/moveSpeed);
                path_start(mypath,moveSpeed,0,false);
                
                if (path_get_number(mypath) == 2)
                {
                    finalX = path_get_point_x(mypath, 1);
                    finalY = path_get_point_y(mypath, 1);
                    
                    collisionObjectId = collision_point(finalX,finalY,obj_player_blue,false,false);
                    if (collisionObjectId)
                    {
                        path_start(mypath,0,0,false); //Stops the path
                        draw_sprite_ext(sprite_index,image_index,x,y,1,1,image_angle,-1,1);
                    }
                       
                 }
                 else
                 {
                    actionPoints -= 1;
                 }
                 
                
            }
            
            //moveTimer -= moveSpeed;
            move_snap( moveSpeed, moveSpeed );
            //image_angle = direction+270;
            draw_sprite_ext(sprite_index,image_index,x,y,1,1,image_angle,-1,1);
        }
        
        if (path_get_number(mypath) &gt; 2)
        {
            futureX = path_get_point_x(mypath, 1);
            futureY = path_get_point_y(mypath, 1);
            
            //pathIncrement = 1/(gridSize/moveSpeed);
            checkCollisionRed = place_meeting(futureX,futureY,obj_player_red);
            if (checkCollisionRed)
            {
                //show_message("Collide");
                path_start(mypath,0,0,false); //Stops the path
                draw_sprite_ext(sprite_index,image_index,x,y,1,1,image_angle,-1,1);
            }
        }
    }
    else
    {
        path_start(mypath,0,0,false); //Stops the path
        image_angle = direction+270;
        draw_sprite_ext(sprite_index,image_index,x,y,1,1,image_angle,-1,1);
        //moveTimer -= moveSpeed;
        //global.endTurn = true;
    }
    
  
    
    draw_path(mypath,x,y,true);
    //Draw mp_grid on screen
    /*
    draw_set_alpha(0.1);
    mp_grid_draw(AI_grid);
    for (i=0; i&lt;room_width; i+=64)
    {
      draw_line(i,0,i,room_height);
    }
    for(ii=0; ii&lt;room_height; ii+=64)
    {
      draw_line(0,ii,room_width,ii);
    }
    draw_set_alpha(1);
    */
    
    
    //firstRoundTimer = gridSize - moveSpeed;
    //show_message("firstRoundTimer: " + string(firstRoundTimer) + ", moveTimer: " + string(moveTimer));
    if (numberOfAttacks &gt; 0 &amp;&amp; moveTimer == gridSize )
    {
        //show_message();      
        if (path_get_number(mypath) == 2)
        {
            //show_message("firstRoundTimer: " + string(firstRoundTimer) + ", moveTimer: " + string(moveTimer));
            finalX = path_get_point_x(mypath, 1);
            finalY = path_get_point_y(mypath, 1);
            
            //checkCollisionBlue = place_meeting(futureX,futureY,obj_player_blue);
            collisionObjectId = collision_point(finalX,finalY,obj_player_blue,false,false);
            if (collisionObjectId)
            {
                script_combat_trigger(collisionObjectId);
                //numberOfAttacks-=1;
                
                path_start(mypath,0,0,false); //Stops the path
                draw_sprite_ext(sprite_index,image_index,x,y,1,1,image_angle,-1,1);
            }
               
         }
         else
         {
            //show_message("actionPoints2: " + string(actionPoints));
            if ( actionPoints &lt; 0)
            {
                show_message("FIRST END");
                global.endTurn = true;
            }
         }
    }
    else if (numberOfAttacks == 0)
    {
        if ( actionPoints== 0)
        {
            //show_message("BLAJH");
            global.endTurn = true;
        }    
    }
    
    
    if (moveTimer == 0 )
    {
        move_snap( moveSpeed, moveSpeed );
        //show_message("x: " + string(round(x)) + "y: " + string(round(y)));
        if (((y+32)%64 == 0))
        {
            path_start(mypath,0,0,false); //Stops the path
            moveTimer = gridSize;
            createNewPath = true;
            //show_message("Snap");
        }
    }
    else
    {
        moveTimer -= moveSpeed;
    }
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
